<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:jms="http://www.springframework.org/schema/jms"
       xmlns:p="http://www.springframework.org/schema/p"
       xmlns:context="http://www.springframework.org/schema/context"
       xmlns:tx="http://www.springframework.org/schema/tx"
       xsi:schemaLocation="
    http://www.springframework.org/schema/beans 
    http://www.springframework.org/schema/beans/spring-beans.xsd
    http://www.springframework.org/schema/jms 
    http://www.springframework.org/schema/jms/spring-jms.xsd
    http://www.springframework.org/schema/context 
    http://www.springframework.org/schema/context/spring-context.xsd
    http://www.springframework.org/schema/tx
    http://www.springframework.org/schema/tx/spring-tx-3.0.xsd">

	    
    <tx:annotation-driven transaction-manager="messageListener" proxy-target-class="true"/>
  	         
    <bean id="connectionFactory" class="com.ibm.mq.jms.MQQueueConnectionFactory">
        <property name="hostName" value="@monitor.jms.hostName@" />
        <property name="port" value="@monitor.jms.port@" />
        <property name="queueManager" value="@monitor.jms.queueManager@" />
        <property name="transportType" value="@monitor.jms.transportType@" />
        <property name="channel" value="@monitor.jms.channel@" />
    </bean>
	

    <!-- JMS Queue Connection Factory -->
    <bean id="jmsQueueConnectionFactory"
              class="org.springframework.jms.connection.SingleConnectionFactory102">
        <property name="targetConnectionFactory">
            <ref bean="connectionFactory" />
        </property>
        <property name="pubSubDomain">
            <value>false</value>
        </property>
    </bean>

    <!-- JMS Destination Resolver -->
    <bean id="jmsDestinationResolver"
              class="org.springframework.jms.support.destination.DynamicDestinationResolver">
    </bean>
  
    <bean id="jmsTemplate102" class="org.springframework.jms.core.JmsTemplate102">
        <property name="connectionFactory">
            <ref bean="jmsQueueConnectionFactory" />
        </property>
        <property name="destinationResolver">
            <ref bean="jmsDestinationResolver" />
        </property>
        <property name="pubSubDomain">
            <value>false</value>
        </property>
        <property name="receiveTimeout">
            <value>20000</value>
        </property>
    </bean>
  
    <!-- /beansMQSeries -->
  
  
    <bean id="listenerLogger" class="mx.com.telcel.di.sds.gsac.dsc.ws.main_application.wsm2k_monitor.business.messaging.ListenerLogger" />
    
    <bean id="listenerAnalytic" class="mx.com.telcel.di.sds.gsac.dsc.ws.main_application.wsm2k_monitor.business.messaging.ListenerAnalytic" />
    
    <bean id="listenerContainerLogger" class="org.springframework.jms.listener.DefaultMessageListenerContainer" >
        <property name="maxConcurrentConsumers" value="40"/>
        <property name="concurrentConsumers" value="40"/>
        <property name="connectionFactory" ref="connectionFactory"/>
        <property name="destination" ref="jmsDestinationLogs"/>
        <property name="messageListener" ref="listenerLogger"/>
    </bean>
    
    <bean id="listenerContainerAnalytic" class="org.springframework.jms.listener.DefaultMessageListenerContainer" >
  	<property name="maxConcurrentConsumers" value="10"/>
  	<property name="concurrentConsumers" value="10"/>
  	<property name="connectionFactory" ref="connectionFactory"/>
  	<property name="destination" ref="jmsDestinationAnalyzer"/>
  	<property name="messageListener" ref="listenerAnalytic"/>
  </bean>
  
    <bean id="jmsDestinationLogs" class="com.ibm.mq.jms.MQQueue">
        <constructor-arg value="@monitor.jms.queue.logger@"/>
    </bean>
    
    <bean id="jmsDestinationAnalyzer" class="com.ibm.mq.jms.MQQueue">
        <constructor-arg value="@monitor.jms.queue.analyzer@"/>
    </bean>
  
    <!--BEANS PETICIONES PUBLISHER-->
    <bean id="topicConnectionFactory" class="com.ibm.mq.jms.MQTopicConnectionFactory">
        <property name="hostName" value="@monitor.jms.hostName@" />
        <property name="port" value="@monitor.jms.port@" />
        <property name="queueManager" value="@monitor.jms.queueManager@" />
        <property name="transportType" value="@monitor.jms.transportType@" />
        <property name="channel" value="@monitor.jms.channel@" />
    </bean>
  
    <!-- JMS Topic Connection Factory -->
    <bean id="jmsTopicConnectionFactory" class="org.springframework.jms.connection.SingleConnectionFactory102">
        <property name="targetConnectionFactory">
            <ref bean="topicConnectionFactory" />
        </property>
        <property name="pubSubDomain">
            <value>true</value>
        </property>
    </bean>
  
    <!-- JMS Destination Resolver -->
    <bean id="jmsTopicDestinationResolver" class="org.springframework.jms.support.destination.DynamicDestinationResolver" />
  
    <bean id="jmsTopicTemplate102" class="org.springframework.jms.core.JmsTemplate102">
        <property name="connectionFactory">
            <ref bean="jmsTopicConnectionFactory" />
        </property>
        <property name="destinationResolver">
            <ref bean="jmsTopicDestinationResolver" />
        </property>
        <property name="pubSubDomain">
            <value>true</value>
        </property>
        <property name="receiveTimeout">
            <value>20000</value>
        </property>
    </bean>
</beans>
